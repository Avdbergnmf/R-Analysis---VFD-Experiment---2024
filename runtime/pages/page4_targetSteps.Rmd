
### Options
```{r,echo=FALSE}
selectizeInput("targetPlotPlot", "Plot",
  choices = dataTypesTargets, selected = dataTypesTargets[2], multiple = FALSE
)
selectizeInput("targetPlotGroup", "Group by",
  choices = categoriesInputs, selected = categoriesInputs[1], multiple = FALSE
)
selectizeInput("targetPlotPosition", "Bar positions",
  choices = c("stack", "identity", "dodge"), selected = "identity", multiple = FALSE
)
selectizeInput("targetPlotSplit", "Split by",
  choices = categoriesInputs, selected = "None", multiple = FALSE
)

numericInput("targetPlotBin", "Bin width",
  min = 0.001, max = 0.5, value = 0.01, step = 0.01
)
```

Column
--------------------------------------------

### Histograms  {data-height=1000}
```{r}
plotOutput("histTargets")
```

### Target Steps  {data-height=1000}
```{r}
plotOutput("targets")
```


```{r, context="server"}
output$targets <- renderPlot({
  p <- make_target_steps_plot(filteredTargetParams(), baseSize=input$baseSize)
  
  return(p)
}, height = reactive(input$plotheight))

output$histTargets <- renderPlot(
  {
    make_target_histogram(filteredTargetParams(), input$targetPlotGroup, input$targetPlotSplit, input$targetPlotPlot, input$targetPlotBin, input$targetPlotPosition, baseSize = input$baseSize)
  },
  height = reactive(plotHeight())
)
```